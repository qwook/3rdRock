{"version":3,"sources":["../../src/Tweet.js"],"names":[],"mappings":"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","file":"Tweet.js","sourcesContent":["\nimport Beacon from './Beacon.js';\n\nconst canvasWrapper = document.getElementById(\"canvasWrapper\");\n\nvar leftSide = document.getElementById(\"leftSide\");\nvar rightSide = document.getElementById(\"rightSide\");\nvar biggieSmalls = document.getElementById(\"biggieSmalls\");\n\nexport default class Tweet extends THREE.Object3D {\n\n  constructor(data) {\n    super();\n\n    this.data = data;\n\n    var tweetEle = document.createElement(\"div\");\n    tweetEle.className = \"popupDisplay tweet\";\n    tweetEle.textContent = data.title;\n    tweetEle.style.top = \"0px\";\n    tweetEle.style.left = \"0px\";\n    this.tweetEle = tweetEle;\n\n    canvasWrapper.appendChild(tweetEle);\n\n    var beacon = new Beacon();\n    this.add(beacon);\n    beacon.rotation.x = -Math.PI/2;\n    beacon.position.z = -2.5;\n    this.beacon = beacon;\n\n\n    var updateListener = () => {\n      this.update();\n    };\n\n    global.events.addEventListener('update', updateListener);\n\n    this.addEventListener('removed', () => {\n      this.destroy();\n      global.events.removeEventListener('update', updateListener);\n    })\n\n    this.hovering = false;\n\n    this.tweetEle.addEventListener('mouseover', (e) => {\n      this.startHover();\n    });\n\n    this.tweetEle.addEventListener('mouseleave', (e) => {\n      this.stopHover();\n    });\n\n    this.hoverTime = 0;\n\n    this.isGoing = false;\n\n    this.tweetEle.addEventListener('click', (e) => {\n      this.onClick();\n    });\n\n  }\n\n  startHover() {\n    var children = this.tweetEle.parentNode.childNodes;\n    for (var i in children) {\n      var child = children[i];\n      if (child.classList && child.classList.contains && child.classList.contains(\"popupDisplay\") > 0) {\n        child.overrideOpacity = true;\n        child.style.opacity = 0.11;\n      }\n    }\n    this.tweetEle.overrideOpacity = true;\n    this.tweetEle.style.opacity = 1;\n    this.beacon.mesh.material.opacity = 1;\n    this.hovering = true;\n  }\n\n  stopHover() {\n    var children = this.tweetEle.parentNode.childNodes;\n    for (var i in children) {\n      var child = children[i];\n      if (child.classList && child.classList.contains && child.classList.contains(\"popupDisplay\") > 0) {\n        child.overrideOpacity = false;\n      }\n    }\n    this.beacon.mesh.material.opacity = 0.5;\n    this.hovering = false;\n  }\n\n  onClick() {\n    leftSide.className = \"\";\n    rightSide.className = \"\";\n    biggieSmalls.className = \"\";\n    leftSide.scrollTop = 0;\n    rightSide.scrollTop = 0;\n    biggieSmalls.scrollTop = 0;\n\n    var lol = new THREE.Vector3(0,0,0);\n    this.localToWorld(lol);\n    // camera.position.copy( lol );\n\n    this.goal = lol.multiplyScalar(1.2);\n    this.isGoing = true;\n    controls.enabled = false;\n    controls.locking = true;\n\n    events.dispatchEvent({type: 'changeFocus', data: this.data});\n  }\n\n  destroy() {\n    this.tweetEle.parentNode.removeChild(this.tweetEle);\n  }\n\n  update() {\n\n    if (this.isGoing) {\n      camera.position.lerp(this.goal, 0.1);\n      if ( camera.position.distanceTo(this.goal) < 0.1 ) {\n        this.isGoing = false;\n        controls.enabled = true;\n        setTimeout(() => {\n          controls.locking = false;\n        }, 1);\n      }\n    }\n\n\n    var pos3D = this.localToWorld(new THREE.Vector3(0,0,0));\n\n    // pos3D.z += 2;\n\n    var pos = calc3Dto2D(pos3D);\n    // console.log(pos);\n    this.tweetEle.style.left = Math.floor((pos.x+1)/2*window.innerWidth) + 'px';\n    this.tweetEle.style.top = Math.floor(window.innerHeight-Math.floor((pos.y+1)/2*window.innerHeight)) + 'px';\n    // this.tweetEle.style.opacity\n\n    if (!this.tweetEle.overrideOpacity) {\n      var dist = camera.position.length()/2;\n      var opacity = (dist-camera.position.distanceTo(pos3D))/dist;\n      if (opacity < 0) {\n        opacity = 0;\n        this.tweetEle.style.display = 'none';\n      } else {\n        this.tweetEle.style.display = 'inline-block';\n      }\n\n      if (opacity > 1) {\n        opacity = 1;\n      }\n\n      this.tweetEle.style.opacity = opacity;\n    }\n\n    if (this.tweetEle.style.opacity <= 0) {\n      this.tweetEle.style.opacity = 0;\n      this.tweetEle.style.display = 'none';\n    } else {\n      if (this.hovering) {\n        this.tweetEle.style.display = 'inline-block';\n      }\n    }\n\n\n    this.lookAt(new THREE.Vector3(0,0,0));\n\n  }\n\n};\n"]}